<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Invoice - {% if order %}{{ order.order_number }}{% else %}{{ order_number }}{% endif %}</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            color: #333;
        }
        .header, .footer {
            text-align: center;
        }
        .invoice-box {
            border: 1px solid #eee;
            padding: 20px;
            margin-top: 20px;
        }
        .invoice-box table {
            width: 100%;
            line-height: 1.6;
            text-align: left;
            border-collapse: collapse;
        }
        .invoice-box table td, .invoice-box table th {
            padding: 8px;
            border: 1px solid #ddd;
        }
        .title {
            font-size: 24px;
            font-weight: bold;
        }
        .total {
            font-weight: bold;
            font-size: 18px;
        }
        .error {
            color: red;
            font-size: 20px;
            text-align: center;
            margin-top: 100px;
        }
    </style>
</head>
<body>

{% if order %}
    <div class="header">
        <h2>Invoice</h2>
        <p><strong>Invoice Number:</strong> {{ order.order_number }}</p>
        <p><strong>Date:</strong> {{ order.pickup_date }}</p>
    </div>

    <div class="invoice-box">
        <table>
            <tr>
                <td>
                    <strong>Customer Details:</strong><br>
                    {{ order.first_name }} {{ order.last_name }}<br>
                    {{ order.email }}<br>
                    {{ order.phone }}
                </td>
                <td class="right">
                    <strong>Pickup Details:</strong><br>
                    {{ order.pickup_date }}<br>
                    {{ order.pickup_time }}
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <strong>Shipping Address:</strong><br>
                    {{ order.address_line_1 }}, {{ order.address_line_2 }}<br>
                    {{ order.city }}, {{ order.state }}, {{ order.country }}
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <strong>Order Note:</strong><br>
                    {{ order.order_note }}
                </td>
            </tr>
        </table>

        <hr>
        <h3>Items Ordered</h3>
        <table>
            <thead>
                <tr>
                    <th>Subcategory</th>
                    <th>Unit</th>
                    <th>Qty</th>
                    <th>Price</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody>
                {% for item in order_items %}
                <tr>
                    <td>{{ item.subcategory_name }}</td>
                    <td>{{ item.unit }}</td>
                    <td>{{ item.quantity }}</td>
                    <td style="text-align:right;">Rs. {{ item.price|floatformat:2 }}</td>
                    <td style="text-align:right;">Rs. {{ item.total|floatformat:2 }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5">No items found</td>
                </tr>
                {% endfor %}
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="4"><strong>Grand Total</strong></td>
                    <td style="text-align:right;"><strong>Rs. {{ grand_total|floatformat:2 }}</strong></td>
                </tr>
            </tfoot>
        </table>

        <br>
        <table>
            <tr>
                <td><strong>Subtotal:</strong></td>
                <td style="text-align:right;">Rs. {{ order.order_total|floatformat:2 }}</td>
            </tr>
            <tr>
                <td><strong>Tax:</strong></td>
                <td style="text-align:right;">Rs. {{ order.tax|floatformat:2 }}</td>
            </tr>
            <tr>
                <td class="total">Total:</td>
                <td style="text-align:right;" class="total">Rs. {{ order.order_total|add:order.tax|floatformat:2 }}</td>
            </tr>
        </table>
    </div>

    <div class="footer">
        <p>
        <a href="?download=pdf" style="text-decoration: none;">
            <button style="padding: 10px 20px; background: #4CAF50; color: white; border: none; font-size: 16px;">
            Download PDF
            </button>
        </a>
        </p>
        <p>Thank you for your business!</p>
    </div>

{% else %}
    <div class="error">
        <p>No details found for order number <strong>{{ order_number }}</strong>.</p>
        <p>Please check the order number and try again.</p>
    </div>
{% endif %}

</body>
</html>
